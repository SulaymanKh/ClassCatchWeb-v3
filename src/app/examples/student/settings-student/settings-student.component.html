<div class="wrapper">
    <!-- Page Header -->
    <div class="page-header page-header-xs" data-parallax="true" style="background-image: url('./assets/img/banner.jpg');">
      <div class="filter"></div>
    </div>
    <!-- Profile Content Section -->
    <div class="section profile-content">
      <div class="container">
        <div class="row gutters-sm">
          <div class="col-md-4 d-none d-md-block">
            <div class="card">
              <div class="card-body">
                <nav class="nav flex-column nav-pills nav-gap-y-1">
                  <a (click)="selectTab('profile')" [ngClass]="{'active': activeTab === 'profile'}" class="nav-item nav-link has-icon nav-link-faded">
                    <i class="fas fa-user mr-2"></i>Profile Information
                  </a>
                  <a (click)="selectTab('account')" [ngClass]="{'active': activeTab === 'account'}" class="nav-item nav-link has-icon nav-link-faded">
                    <i class="fas fa-cog mr-2"></i>Account Settings
                  </a>
                  <a (click)="selectTab('security')" [ngClass]="{'active': activeTab === 'security'}" class="nav-item nav-link has-icon nav-link-faded">
                    <i class="fas fa-shield-alt mr-2"></i>Security
                  </a>
                  <a (click)="selectTab('notification')" [ngClass]="{'active': activeTab === 'notification'}" class="nav-item nav-link has-icon nav-link-faded">
                    <i class="fas fa-bell mr-2"></i>Notification
                  </a>
                  <a (click)="selectTab('billing')" [ngClass]="{'active': activeTab === 'billing'}" class="nav-item nav-link has-icon nav-link-faded">
                    <i class="fas fa-credit-card mr-2"></i>Billing
                  </a>
                </nav>
              </div>
            </div>
          </div>
          <div class="col-md-8">
            <div class="card">
              <div class="card-header border-bottom mb-3 d-flex d-md-none">
                <ul class="nav nav-tabs card-header-tabs nav-gap-x-1" role="tablist">
                  <li class="nav-item">
                    <a (click)="selectTab('profile')" [ngClass]="{'active': activeTab === 'profile'}" class="nav-link has-icon">
                      <i class="fas fa-user"></i> Profile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a (click)="selectTab('account')" [ngClass]="{'active': activeTab === 'account'}" class="nav-link has-icon">
                      <i class="fas fa-cog"></i> Account
                    </a>
                  </li>
                  <li class="nav-item">
                    <a (click)="selectTab('security')" [ngClass]="{'active': activeTab === 'security'}" class="nav-link has-icon">
                      <i class="fas fa-shield-alt"></i> Security
                    </a>
                  </li>
                  <li class="nav-item">
                    <a (click)="selectTab('notification')" [ngClass]="{'active': activeTab === 'notification'}" class="nav-link has-icon">
                      <i class="fas fa-bell"></i> Notification
                    </a>
                  </li>
                  <li class="nav-item">
                    <a (click)="selectTab('billing')" [ngClass]="{'active': activeTab === 'billing'}" class="nav-link has-icon">
                      <i class="fas fa-credit-card"></i> Billing
                    </a>
                  </li>
                </ul>
              </div>
              <div class="card-body tab-content">
                <div *ngIf="activeTab === 'profile'" id="profile">
                    <h6>YOUR PROFILE INFORMATION</h6>
                    <hr>
                    <div class="row">
                      <div class="col-md-6">
                        <form [formGroup]="profile" class="mt-4" (ngSubmit)="updateUserDetails()">
                          <div class="form-group">
                            <label for="firstname">Firstname</label>
                            <input type="text" id="firstname" class="form-control" formControlName="firstname" placeholder="Brown" />
                          </div>
                          <div class="form-group">
                            <label for="lastname">Lastname</label>
                            <input type="text" id="lastname" class="form-control" formControlName="lastname" placeholder="Asher" />
                            <small class="form-text text-muted">Your name may appear around here where you are mentioned. You can change or remove it at any time.</small>
                          </div>
                          <div class="form-group">
                            <label for="inputEmail4">Email</label>
                            <input type="email" class="form-control" id="inputEmail4" formControlName="email" placeholder="brown@asher.me" />
                          </div>
                          <div class="form-group">
                            <label for="profilePicture">Profile Picture</label>
                            <input type="file" class="form-control-file" id="profilePicture" (change)="onProfilePictureChange($event)" />
                          </div>
                          <button type="submit" class="btn btn-primary">Update Personal Information</button>
                        </form>
                      </div>
                  
                      <!-- Horizontal line for mobile view -->
                      <div class="col-12 d-md-none">
                        <hr>
                      </div>
                  
                      <div class="col-md-6">
                        <form [formGroup]="userProfileInformation" class="mt-4" (ngSubmit)="updateUserProfileDetails()">
                          <div class="form-group">
                            <label for="bio">Your Bio</label>
                            <textarea class="form-control autosize" id="bio" placeholder="Write something about you" formControlName="bio" name="bio" rows="3"></textarea>
                          </div>
                          <div class="form-group">
                            <label for="url">URL</label>
                            <input type="text" class="form-control" id="url" placeholder="Enter your website address" formControlName="url" name="url">
                          </div>
                          <div class="form-group">
                            <label for="location">Location</label>
                            <input type="text" class="form-control" id="location" placeholder="Enter your location" formControlName="location" name="location">
                          </div>
                          <div class="form-group small text-muted">
                            All of the fields on this page are optional and can be deleted at any time, and by filling them out, you're giving us consent to share this data wherever your user profile appears.
                          </div>
                          <button type="submit" class="btn btn-primary">Update Profile Information</button>
                        </form>
                      </div>
                    </div>
                </div>
                  
                  
                <div *ngIf="activeTab === 'account'" id="account">
                  <h6>ACCOUNT SETTINGS</h6>
                  <hr>
                  <form (ngSubmit)="onSubmitAccount()">
                    <div class="form-group">
                      <label for="username">Username</label>
                      <input type="text" class="form-control" id="username" placeholder="Enter your username" [(ngModel)]="account.username" name="username">
                      <small class="form-text text-muted">After changing your username, your old username becomes available for anyone else to claim.</small>
                    </div>
                    <hr>
                    <div class="form-group">
                      <label class="d-block text-danger">Delete Account</label>
                      <p class="text-muted font-size-sm">Once you delete your account, there is no going back. Please be certain.</p>
                    </div>
                    <button class="btn btn-danger" type="button" (click)="deleteAccount()">Delete Account</button>
                  </form>
                </div>
                <div *ngIf="activeTab === 'security'" id="security">
                  <h6>SECURITY SETTINGS</h6>
                  <hr>
                  <form (ngSubmit)="onSubmitSecurity()">
                    <div class="form-group">
                      <label class="d-block">Change Password</label>
                      <input type="password" class="form-control" placeholder="Enter your old password" [(ngModel)]="security.oldPassword" name="oldPassword">
                      <input type="password" class="form-control mt-1" placeholder="New password" [(ngModel)]="security.newPassword" name="newPassword">
                      <input type="password" class="form-control mt-1" placeholder="Confirm new password" [(ngModel)]="security.confirmPassword" name="confirmPassword">
                    </div>
                    <button type="submit" class="btn btn-primary">Change Password</button>
                  </form>
                  <hr>
                  <!-- <form>
                    <div class="form-group">
                      <label class="d-block">Two Factor Authentication</label>
                      <button class="btn btn-info" type="button" (click)="enableTwoFactor()">Enable two-factor authentication</button>
                      <p class="small text-muted mt-2">Two-factor authentication adds an additional layer of security to your account by requiring more than just a password to log in.</p>
                    </div>
                  </form>
                  <hr> -->
                  <!-- <form>
                    <div class="form-group mb-0">
                      <label class="d-block">Sessions</label>
                      <p class="font-size-sm text-secondary">This is a list of devices that have logged into your account. Revoke any sessions that you do not recognize.</p>
                      <ul class="list-group list-group-sm">
                        <li class="list-group-item has-icon" *ngFor="let session of security.sessions">
                          <div>
                            <h6 class="mb-0">{{session.location}}</h6>
                            <small class="text-muted">{{session.details}}</small>
                          </div>
                          <button class="btn btn-light btn-sm ml-auto" type="button" (click)="revokeSession(session.id)">Revoke</button>
                        </li>
                      </ul>
                    </div>
                  </form> -->
                </div>
                <!-- <div *ngIf="activeTab === 'notification'" id="notification">
                  <h6>NOTIFICATION SETTINGS</h6>
                  <hr>
                  <form (ngSubmit)="onSubmitNotification()">
                    <div class="form-group">
                      <label class="d-block mb-0">Security Alerts</label>
                      <div class="small text-muted mb-3">Receive security alert notifications via email</div>
                      <div class="custom-control custom-checkbox">
                        <input type="checkbox" class="custom-control-input" id="customCheck1" [(ngModel)]="notification.securityAlerts" name="securityAlerts">
                        <label class="custom-control-label" for="customCheck1">Email each time a vulnerability is found</label>
                      </div>
                      <div class="custom-control custom-checkbox">
                        <input type="checkbox" class="custom-control-input" id="customCheck2" [(ngModel)]="notification.digestSummary" name="digestSummary">
                        <label class="custom-control-label" for="customCheck2">Email a digest summary of vulnerability</label>
                      </div>
                    </div>
                    <div class="form-group mb-0">
                      <label class="d-block">SMS Notifications</label>
                      <ul class="list-group list-group-sm">
                        <li class="list-group-item has-icon" *ngFor="let sms of notification.smsNotifications">
                          {{sms.name}}
                          <div class="custom-control custom-control-nolabel custom-switch ml-auto">
                            <input type="checkbox" class="custom-control-input" [id]="'customSwitch' + sms.id" [(ngModel)]="sms.enabled" [name]="'notification' + sms.id">
                            <label class="custom-control-label" [for]="'customSwitch' + sms.id"></label>
                          </div>
                        </li>
                      </ul>
                    </div>
                    <button type="submit" class="btn btn-primary mt-3">Save Changes</button>
                  </form>
                </div> -->
                <div *ngIf="activeTab === 'billing'" id="billing">
                  <h6>BILLING SETTINGS</h6>
                  <hr>
                  <form (ngSubmit)="onSubmitBilling()">
                      <div class="form-group">
                          <label class="d-block mb-0">Payment Method</label>
                          <div *ngIf="paymentInformation.length > 0; else noPaymentMethod">
                              <div *ngFor="let card of paymentInformation" class="card mt-3 credit-card" [ngClass]="{'border-success': card.isDefault}">
                                  <div class="card-body">
                                      <div class="card-details">
                                          <span *ngIf="card.isDefault" class="badge badge-light-success fs-7 ms-2">Default</span>
                                          <img class="card-logo" [src]="getCardLogo(card.brand)" alt="{{ card.brand }}">
                                          <div class="card-number">**** **** **** {{ card.maskedCardNumber }}</div>
                                          <div class="card-holder">
                                              <span class="card-label">Card Holder</span>
                                              <p class="card-info">{{ card.cardHolderName}}</p>
                                          </div>
                                          <div class="card-expires">
                                              <span class="card-label">Expires</span>
                                              <p class="card-info">{{ card.expiryDate }}</p>
                                          </div>
                                      </div>
                                      <button class="btn btn-danger" type="button" (click)="removeCard(card.bankCardID)">Remove</button>
                                      <button *ngIf="!card.isDefault" class="btn btn-secondary" type="button" (click)="setDefaultCard(card.bankCardID)">Set as Default</button>
                                  </div>
                              </div>                        
                          </div>
                          <ng-template #noPaymentMethod>
                              <div class="small text-muted mb-3">You have not added a payment method</div>
                          </ng-template>
                          <button class="btn btn-info" type="button" (click)="addPaymentMethod()">Add Payment Method</button>
                      </div>
                      <div class="form-group mb-0">
                          <label class="d-block">Payment History</label>
                          <div class="border border-gray-500 bg-gray-200 p-3 text-center font-size-sm">You have not made any payment.</div>
                      </div>
                  </form>                    
              </div>
              
              </div>
            </div>
          </div>
        </div>
    </div>
    <ngx-spinner 
        *ngIf="loading" 
        bdColor="rgba(0, 0, 0, 0.5)" 
        size="medium"
        color="#fff" 
        type="ball-scale-multiple">
    </ngx-spinner>
</div>
  